<!DOCTYPE html>
<html>
<head>
    <title>Compare Admin vs Manual Data</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #0f0; }
        .success { color: #0f0; }
        .error { color: #f00; }
        .warning { color: #ff0; }
        button { background: #0f0; color: #000; border: none; padding: 10px; margin: 5px; }
        pre { background: #111; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Compare Working vs Failing Data</h1>
    
    <div class="test">
        <h2>‚úÖ Working Manual Test Data</h2>
        <button onclick="testWorkingData()">Test Working Data</button>
        <pre id="working-result"></pre>
    </div>
    
    <div class="test">
        <h2>üß™ Simulate Admin Panel Data</h2>
        <button onclick="testAdminData()">Test Admin-like Data</button>
        <pre id="admin-result"></pre>
    </div>

    <script src="supabase-config.js"></script>
    <script src="database.js"></script>
    
    <script>
        async function testWorkingData() {
            const workingData = {
                name: "Working Test Item",
                price: 99.99,
                category: "electronics", 
                reason: "This data structure works",
                url: "https://example.com",
                imageUrl: null,
                crossedOff: false
            };
            
            document.getElementById('working-result').innerHTML = 
                `üì¶ Sending: ${JSON.stringify(workingData, null, 2)}\n\n`;
            
            try {
                const db = new WishlistDatabase();
                const result = await db.addItem(workingData);
                document.getElementById('working-result').innerHTML += 
                    `‚úÖ SUCCESS: ${JSON.stringify(result, null, 2)}`;
            } catch (error) {
                document.getElementById('working-result').innerHTML += 
                    `‚ùå FAILED: ${error.message}`;
            }
        }

        async function testAdminData() {
            // Simulate exactly what admin panel creates
            const adminData = {
                id: Date.now(), // Admin includes ID
                name: "Admin Test Item",
                price: 49.99,
                url: "https://example.com",
                category: "electronics",
                reason: "Testing admin data structure", 
                imageUrl: null,
                crossedOff: false
            };
            
            document.getElementById('admin-result').innerHTML = 
                `üì¶ Sending: ${JSON.stringify(adminData, null, 2)}\n\n`;
            
            try {
                const db = new WishlistDatabase();
                const result = await db.addItem(adminData);
                document.getElementById('admin-result').innerHTML += 
                    `‚úÖ SUCCESS: ${JSON.stringify(result, null, 2)}`;
            } catch (error) {
                document.getElementById('admin-result').innerHTML += 
                    `‚ùå FAILED: ${error.message}`;
                console.error('Full error:', error);
            }
        }

        // Test different scenarios
        async function testEdgeCases() {
            const tests = [
                {
                    name: "Empty reason",
                    data: { name: "Test", price: 10, category: "electronics", reason: "", url: "", imageUrl: null, crossedOff: false }
                },
                {
                    name: "No URL", 
                    data: { name: "Test", price: 10, category: "electronics", reason: "test", url: null, imageUrl: null, crossedOff: false }
                },
                {
                    name: "With ID (like admin)",
                    data: { id: 999, name: "Test", price: 10, category: "electronics", reason: "test", url: "", imageUrl: null, crossedOff: false }
                }
            ];
            
            for (const test of tests) {
                console.log(`üß™ Testing: ${test.name}`);
                try {
                    const db = new WishlistDatabase();
                    await db.addItem(test.data);
                    console.log(`‚úÖ ${test.name}: SUCCESS`);
                } catch (error) {
                    console.error(`‚ùå ${test.name}: FAILED -`, error.message);
                }
            }
        }

        // Auto-run edge cases
        setTimeout(testEdgeCases, 1000);
    </script>
</body>
</html>
